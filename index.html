<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>S13 Live Schedule</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg,#001f3f,#003366);
    color: white;
    text-align: center;
    padding: 50px;
}

.card {
    background: rgba(255,255,255,0.1);
    padding: 30px;
    border-radius: 15px;
    width: 400px;
    margin: auto;
}

h1 {
    margin-bottom: 10px;
}

.time {
    font-size: 22px;
    margin-bottom: 20px;
}

.course {
    font-size: 26px;
    font-weight: bold;
    color: #00ffcc;
}

.small {
    margin-top: 10px;
    font-size: 14px;
    opacity: 0.7;
}
</style>
</head>
<body>

<div class="card">
    <h1>S13 Live Course</h1>
    <div class="time" id="currentTime"></div>
    <div class="course" id="courseDisplay"></div>
    <div class="small" id="ramadanStatus"></div>
</div>

<script>

// ===== CONFIG =====
const ramadanStart = new Date("2025-02-19");
const ramadanEnd = new Date("2025-03-20");
const semesterStart = new Date("2025-02-16");

// ===== S13 SCHEDULE =====
const schedule = {
    1: { // Monday
        "08:00-10:00": "Organisation et Gestion",
        "10:00-12:00": "Instrumentation et Dynamique"
    },
    2: { // Tuesday
        "10:00-12:00": "Procédés Chimie Minérale 1"
    },
    3: { // Wednesday
        "10:00-12:00": "Régulation & Commande"
    },
    4: { // Thursday
        "08:00-10:00": "Procédés Chimie Organique",
        "10:00-12:00": "Chimie de l'Ingénieur"
    },
    5: { // Friday
        "08:00-10:00": "Innovation & Communication"
    }
};

// ===== RAMADAN SCHEDULE SHIFT =====
function adjustForRamadan(start, end) {
    const [h1,m1] = start.split(":").map(Number);
    const [h2,m2] = end.split(":").map(Number);

    return [
        `${h1+1}:${m1.toString().padStart(2,"0")}`,
        `${h2}:${m2.toString().padStart(2,"0")}`
    ];
}

function getCurrentMoroccoTime() {
    return new Date(
        new Date().toLocaleString("en-US", {timeZone: "Africa/Casablanca"})
    );
}

function checkCourse() {

    const now = getCurrentMoroccoTime();
    document.getElementById("currentTime").innerText =
        now.toLocaleString("en-GB");

    if (now < semesterStart) {
        document.getElementById("courseDisplay").innerText =
            "Semester not started";
        return;
    }

    const isRamadan = now >= ramadanStart && now <= ramadanEnd;

    document.getElementById("ramadanStatus").innerText =
        isRamadan ? "Ramadan Schedule Active" : "Normal Schedule";

    const day = now.getDay();
    const hours = now.getHours();
    const minutes = now.getMinutes();

    if (!schedule[day]) {
        document.getElementById("courseDisplay").innerText =
            "No course today";
        return;
    }

    const currentTime = hours*60 + minutes;

    for (let slot in schedule[day]) {

        let [start,end] = slot.split("-");

        if (isRamadan) {
            [start,end] = adjustForRamadan(start,end);
        }

        const [sh,sm] = start.split(":").map(Number);
        const [eh,em] = end.split(":").map(Number);

        const startMin = sh*60+sm;
        const endMin = eh*60+em;

        if (currentTime >= startMin && currentTime <= endMin) {
            document.getElementById("courseDisplay").innerText =
                schedule[day][slot];
            return;
        }
    }

    document.getElementById("courseDisplay").innerText =
        "No class right now";
}

checkCourse();
setInterval(checkCourse, 60000);

</script>

</body>
</html>
